sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/core/routing/History"],function(e,t,o){"use strict";return e.extend("susproapp.controller.login",{onInit:function(){if(localStorage.getItem("user")){this.getOwnerComponent()._clientId=localStorage.getItem("user")}var e=sap.ui.core.UIComponent.getRouterFor(this);e.getRoute("login").attachMatched(this._onRouteMatched,this)},_onRouteMatched:function(){var e=new t;this.getOwnerComponent().setModel(e,"Login");var o=sap.ui.core.UIComponent.getRouterFor(this);if(localStorage.getItem("user")!=undefined){this.getView().setBusy(true);this.getOwnerComponent().getModel().read("/UserLogin",{urlParameters:{$filter:"Email eq '"+localStorage.getItem("Email")+"' and Password eq '"+localStorage.getItem("Password")+"'"},success:function(e){localStorage.setItem("user",e.results[0].ClientID);localStorage.setItem("Email",e.results[0].Email);localStorage.setItem("Password",e.results[0].Password);this.getView().getParent().getParent().getSideContent().setVisible(true);this.getOwnerComponent()._clientId=e.results[0].ClientID;this._loadOrgChart()}.bind(this)})}},onSubmit:function(){let e=["txtUserId","txtPwd"];var t=this.validateEventFeedbackForm(e);if(t===false){return false}var o=this.getView().getModel("Login").getData();var r=sap.ui.core.UIComponent.getRouterFor(this);this.getView().setBusy(true);this.getOwnerComponent().getModel().read("/UserLogin",{urlParameters:{$filter:"Email eq '"+o.uname+"' and Password eq '"+o.pwd+"'"},success:function(e){localStorage.setItem("user",e.results[0].ClientID);localStorage.setItem("Email",e.results[0].Email);localStorage.setItem("Password",e.results[0].Password);this.getView().getParent().getParent().getSideContent().setVisible(true);this.getOwnerComponent()._clientId=e.results[0].ClientID;this._loadOrgChart()}.bind(this)})},_loadOrgChart:function(){this.getOwnerComponent().getModel().read("/orgChart('"+this.getOwnerComponent()._clientId+"')",{success:function(e){this.getOwnerComponent().getModel("orgChart").setData(e);sap.ui.core.UIComponent.getRouterFor(this).navTo("detailsd1");this.getView().setBusy(false)}.bind(this)})},validateEventFeedbackForm:function(e){var t=this;var o=true;e.forEach(function(e){var r=t.getView().byId(e);if(r.getValue()==""||r.getValue()==undefined){o=false;r.setValueState("Error")}else{r.setValueState("None")}});return o},onNavBack:function(){var e=o.getInstance();var t=e.getPreviousHash();if(t!==undefined&&t!==""){window.history.go(-1)}},onForgetPassword:function(){var e=sap.ui.core.UIComponent.getRouterFor(this);e.navTo("Targetforgotpassword")}})});